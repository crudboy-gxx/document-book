# 2 重构原则

## 2.1 何为重构

> 重构，就是在**不改变软件可观察行为**的前提下，对软件内部结构的一种调整，以**提高软件的可理解新和降低软件的修改成本**。

在使用重构技术开发软件时，我们可以把时间分配给两种行为，一个是添加新功能，第二个是重构。添加新功能的时候，不应该修改既有代码，而只管添加新功能。重构时不应该在添加新功能，而只管改进程序结构。

我们在开发过程中，这两个过程往往是交替进行。首先添加了新功能，然后意识到如果把程序结构改下，功能添加会更容易，然后开始重构，重构好了在继续进行新功能添加。在这个过程中，我们要保持同一时间要么在添加新功能，要么在重构，不要让这两个过程混乱交织起来。

## 2.2 为何重构

我们不能把重构当做软件开发中的“银弹”，但是，重构可以帮助我们良好的控制代码。重构是一个工具，他可以用于以下几个目的。

+ 改进软件设计

  如果没有重构，程序的设计就会逐渐腐败。在完全理解整体的业务和设计之前，我们通常会不断进行需求变更，我们就会变动我们代码。这种变动，往往会引入腐败的元素，导致代码结构的流失，例如重复的代码、多余的代码等。因此，我们需要通过重构来整理代码，以保证代码的结构。

+ 使得软件更容易理解

  代码的可阅读性是一个不可忽略的要求。重构赋予了代码更好的结构，更好的代码结构将带来更好的阅读性；更好的阅读性会使得代码更容易理解。另外，重构可以将你带到更高的理解层次上，因为重构过程中，通常可以使你发现更多的设计层面的东西。

+ 帮助找到BUG

+ 提高编码速度

  有人可能会提出疑问，重构需要时间吗？重构不会降低开发速度吗？

  我们要绝对的相信：良好的设计是快速开发的根本。事实上，拥有良好的设计才可以做到快速开发，才能快速的相应需求的变化。如果没有良好设计，或许在某一段时间内你的进展迅速，但是恶劣的设计很快就会让你的速度慢下来。时间越长，这种恶劣的设计带来的影响就越大，使我们修改和添加功能变得非常耗费时间。

## 2.3 何时重构

> 事不过三，三责重构

不要专门拨出时间来进行重构，重构应该随时随地的进行，不应该为了重构而重构。之所以重构，是以你为你想做别的事，而重构可以帮助你把这些事做好。

+ 添加功能时

  代码的设计无法帮助我们轻松添加所需的特性，通过重构来理解需要修改的代码，来让新特性添加时更轻松。

+ 修补错误时

  调试修补过程中重构，多数是为了让代码更具可读性。

+ 复审代码时

  代码复审可以有效的改善代码质量，可以让知识在团队中传播。重构可以帮助我们复审别人的代码。

## 2.4 怎么对经理说

2.5 重构的难题

2.6 重构与设计

2.7 重构与性能

2.8 重构起源何处