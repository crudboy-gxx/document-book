[TOC]

# 类和接口

## 1.使类和成员的可访问性最小化

尽可能地使每个类或者成员不被外界访问 。

## 2.在公有类中使用公共方法而非成员变量

如果一个类可以在它所在的包之外进行访问，就不应该允许直接访问该类的成员变量，而是通过公共方法进行访问。

这样充分运用了面向对象的思想，运用封装隐藏对象的属性和实现细节，仅对外提供公共访问方式，隔离变化提高灵活性（该类的成员方法变化后，不会影响客户端使用），便于使用（类的内部状态对外是不可见的，简化客户端的使用）。

存在两种情况，允许公有类中暴露成员变量。

+ 第一种是公有类可以暴露不可变的成员变量。这样做是允许的，但是推荐通过公共方法对外暴露成员变量。

+ 第二种是包级私有或私有嵌套类可以暴露成员变量。这种情况下，因为成员变量在包内使用或者类内使用，即使改变了内部数据表示方法，也不会影响客户端使用。

## 3.使可变性最小化

在适合的场景下使用不可变类。

不可变类是指其实例不能被修改的类，每个实例中包含的所有信息都必须在创建该实例的时候提供，并在对象的整个生命周期内固定不变。

不可变类有很多优点：

+ 不可变类比较简单。不可变类只有一种状态（被创建时），并且在整个生命周期中不会发生改变。
+ 不可变对象本质上是线程安全的，它们不要求同步。
+ 不可变对象可以被自由地共享。不用每次都创建实例，从而降低内存占用和垃圾回收的成本。也不需要对对象进行保护性拷贝。

创建一个不可变类需要遵循下面的规则：

+ 不要提供任何会修改对象状态的方法。不给成员变量提供设值方法。
+ 将类声明为final的。这样类就不会被继承。或让类的所有构造器都变成私有的或者包级私
  有的，并添加公有的静态工厂来代替公有的构造器。
+ 声明所有成员变量都是final的，都是私有的。虽然成员变量定义为final即可保证不可变，但是声明私有可以获取更多的灵活性
+ 确保对子任何可变组件的互斥访问。如果类中具有指向可变对象的成员变量，必须保证该类的客户端无法获取指向该对象的引用，并且不要从客户端初始化这个成员变量，也不要返回该对象的引用。必要的时候使用深度拷贝。

大多数不可变类都是用了函数方法，函数方法对操作数进行运算并不修改它，而是返回一个新的对象（java8函数式编程）。和函数方法对应的过程或命令的方法，他们会在过程中改变操作数的状态。

当然不可变类也存在他的缺点，那就是每一个不同的值都需要一个对象。可以通过一个公有的可变配套类，例如string的可变配套类是stringBuilder。

然而，在实际的应用中，为了提供性能，可以对不可变性有所放松。例如，类的延迟初始化，一个不可变类中存在非final域，在第一次调用类的方法的时候才会初始化，然后将结果方法放到缓存中，再次调用个就会返回缓存。并且存在一些中庸的技巧，除非有很好的理由要让类成为可变的类，否则它 就应该是不可变的；如果类不能被做成不可变的，仍然应该尽可能地限制它的可变性；除非有令人信服的理由要使域变成是非final的，否则要使每个域都是private final的；构造器应该创建完全初始化的对象 ，并建立起所有的约束关系。 

## 4.复合优先于继承
## 5.要么为继承而设计并提供文档说明，要么就禁止继承
## 6.接口优于抽象类
## 7.为后代设计接口
## 8.接口只用于定义类型
## 9.类层次优于标签类
## 10.静态成员优于非静态成员类
## 11.限制源文件为单个顶级类

